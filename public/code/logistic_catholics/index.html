<!DOCTYPE html>
<html lang="en-US">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="author" content="John A. Bernau">
<meta name="description" content="This post offers an example of performing logistic regression in R. I’ll cover the following topics:
  Importing data Preparing data Fitting logistic model Generating readable output Assessing model fit Generating predicted probabilities Plotting!  More specifically, I’ll be using the 2005 Gallup Poll of Catholics hosted on the ARDA data archives, to examine the factors that drive catholic opinion on the importance of celibate clergy. This issue became one of national importance when the Boston Globe unearthed the systematic abuse of minors by catholic clery in 2002 (as described in their Pulitzer-Prize-winning book).">

<meta property="og:title" content="Logistic Regression in R: Catholic Opinions on Celibate Clergy" />
<meta property="og:description" content="This post offers an example of performing logistic regression in R. I’ll cover the following topics:
  Importing data Preparing data Fitting logistic model Generating readable output Assessing model fit Generating predicted probabilities Plotting!  More specifically, I’ll be using the 2005 Gallup Poll of Catholics hosted on the ARDA data archives, to examine the factors that drive catholic opinion on the importance of celibate clergy. This issue became one of national importance when the Boston Globe unearthed the systematic abuse of minors by catholic clery in 2002 (as described in their Pulitzer-Prize-winning book)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/code/logistic_catholics/" />

















<title>


     Logistic Regression in R: Catholic Opinions on Celibate Clergy 

</title>
<link rel="canonical" href="/code/logistic_catholics/">







<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">




<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500">



    
    <link rel="stylesheet" href="/css/reset.css?t=2018-06-26%2019%3a30%3a59.557496%20-0400%20EDT%20m%3d%2b0.245913946">
    <link rel="stylesheet" href="/css/pygments.css?t=2018-06-26%2019%3a30%3a59.557496%20-0400%20EDT%20m%3d%2b0.245913946">
    <link rel="stylesheet" href="/css/main.css?t=2018-06-26%2019%3a30%3a59.557496%20-0400%20EDT%20m%3d%2b0.245913946">
    
        <link rel="stylesheet" href="/css/override.css?t=2018-06-26%2019%3a30%3a59.557496%20-0400%20EDT%20m%3d%2b0.245913946">
    




<link rel="shortcut icon"

    href="/img/favicon.ico"

>








</head>


<body lang="en">

<section class="header">
    <div class="container">
        <div class="content">
            
                
                
                
                
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                
                <a href="/"><img class="avatar" src="/img/fb2.jpg" srcset="/img/fb2.jpg 1x"></a>
            
            <a href="/"><div class="name">John A. Bernau</div></a>
            
              <h3 class="self-intro">PhD Candidate, Sociology</h3>
            
            <nav>
                <ul>
                    
                        <li class="nav-research"><a href="/xresearch/"><span>research</span></a></li>
                    
                        <li class="nav-teaching"><a href="/xteaching/"><span>Teaching</span></a></li>
                    
                        <li class="nav-blog"><a href="/blog/"><span>Blog</span></a></li>
                    
                        <li class="nav-code"><a href="/xcode/"><span>Code</span></a></li>
                    
                        <li class="nav-about"><a href="/about/"><span>About</span></a></li>
                    
                        <li class="nav-cv"><a href="/img/bernau_cv_2018.pdf"><span>CV</span></a></li>
                    
                </ul>
            </nav>
        </div>
    </div>
</section>

<section class="icons">
    <div class="container">
        <div class="content">
        
            <a href="https://github.com/johnbernau" target="_blank" rel="noopener"><img class="icon" src="/img/github.svg" alt="github" /></a>
        

        
            <a href="https://twitter.com/johnAbernau" target="_blank" rel="noopener"><img class="icon" src="/img/twitter.svg" alt="twitter" /></a>
        

	

        

        

        
            <a href="https://www.linkedin.com/in/john-bernau-b384a9153" target="_blank" rel="noopener"><img class="icon" src="/img/linkedin.svg" alt="linkedin" /></a>
        

        

        

        

        

        
            <a href="mailto:john.bernau@emory.edu"><img class="icon" src="/img/email.svg" alt="email" /></a>
        

        

        
        </div>
    </div>
</section>

<section class="main">
    <div class="container">
        <div class="content">
            <div class="page-heading">

    Logistic Regression in R: Catholic Opinions on Celibate Clergy

</div>

            <div class="markdown">
                <p>This post offers an example of performing logistic regression in R. I’ll cover the following topics:</p>
<div style="float:right;position: relative; top: -10px; left: 10px;">
<p><img src="http://prodimage.images-bn.com/pimages/9780316055697_p0_v5_s1200x630.jpg" height="400" /></p>
</div>
<ul>
<li><a href="#import">Importing data</a></li>
<li><a href="#prep">Preparing data</a></li>
<li><a href="#model">Fitting logistic model</a></li>
<li><a href="#output">Generating readable output</a></li>
<li><a href="#fit">Assessing model fit</a></li>
<li>Generating predicted probabilities</li>
<li>Plotting!</li>
</ul>
<p>More specifically, I’ll be using the <a href="http://www.thearda.com/Archive/Files/Descriptions/GALLUP05.asp">2005 Gallup Poll of Catholics</a> hosted on the <a href="http://www.thearda.com/Archive/Files/Downloads/GALLUP05_DL2.asp">ARDA data archives</a>, to examine the factors that drive catholic opinion on the importance of celibate clergy. This issue became one of national importance when the Boston Globe unearthed the systematic abuse of minors by catholic clery in 2002 (as described in <a href="https://www.amazon.com/Betrayal-Catholic-findings-investigation-Spotlight/dp/0316271535">their Pulitzer-Prize-winning book</a>). Gallup conducted multiple waves of its catholic poll (1987, 1992, 1993, 1999, and 2005), but I’ll only focus on the most recent wave and set aside any questions of longitudinal trends for now.</p>
<p><strong><em>RQ: How is one’s support for priestly celibacy influenced by factors such as age, sex, politics, mass attendance, or education?</em></strong></p>
<hr />
<pre class="r"><code># Loading required pacakges:
require(&quot;tidyverse&quot;)
require(&quot;foreign&quot;)
require(&quot;car&quot;)
require(&quot;broom&quot;)
require(&quot;stargazer&quot;)
require(&quot;RColorBrewer&quot;)
require(&quot;scales&quot;)</code></pre>
<hr />
<p><a name="import"></a> <strong>Importing Data</strong></p>
<hr />
<p>We’ll use <code>foreign::read.dta()</code> to read the labeled Stata file directly into R from it’s URL.</p>
<pre class="r"><code>gallup &lt;- read.dta(&quot;http://www.thearda.com/download/download.aspx?file=Gallup%20Poll%20of%20Catholics,%202005.DTA&quot;) %&gt;% 
  as_tibble()</code></pre>
<p>An initial glimpse gives us an idea of the 96 different variables, but we’ll need <a href="http://www.thearda.com/Archive/Files/Downloads/GALLUP05_DL2.asp">the codebook</a> to decipher which variables / responses are of interest.</p>
<pre class="r"><code>glimpse(gallup)</code></pre>
<hr />
<p><a name="prep"></a> <strong>Preparing Data</strong></p>
<hr />
<p>Let’s start by examining age. It seems reasonable to expect support for a somewhat traditional belief to vary across generations. First, I remove any missing values and then plot a histogram. We can see a fairly normal distirbution centered around the mean of 52.</p>
<pre class="r"><code># Remove missing values of age
gallup &lt;- gallup %&gt;% 
  filter(age!= &quot;NA&quot;)

# Plot histogram of age, with vertical line at mean
ggplot(gallup, aes(age)) + 
  geom_histogram() +
  geom_vline(xintercept = mean(gallup$age), color = &quot;red&quot;)</code></pre>
<p><img src="/code/logistic_gallup_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>By the same logic, we can include <code>education</code> and <code>sex</code> to our list of relevant variables.</p>
<pre class="r"><code># Bar chart: education X sex
ggplot(gallup, aes(educ)) + 
  geom_bar(aes(fill=sex), stat=&quot;count&quot;, position=&quot;dodge&quot;) + 
  coord_flip()</code></pre>
<p><img src="/code/logistic_gallup_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>It looks like there are slightly more women than men in our sample, and a fairly even distribution across levels of education. Let’s get rid of the cumbersome labels with a bit of recoding. First, examine the default levels of the education variable.</p>
<pre class="r"><code>levels(gallup$educ)</code></pre>
<pre><code>## [1] &quot;Less than a high school graduate (0-11)&quot;             
## [2] &quot;High school graduate (12)&quot;                           
## [3] &quot;Some college&quot;                                        
## [4] &quot;Trade/technical/vocational training&quot;                 
## [5] &quot;College graduate&quot;                                    
## [6] &quot;Postgraduate work or academic or professional degree&quot;
## [7] &quot;Don&#39;t know&quot;                                          
## [8] &quot;Refused&quot;</code></pre>
<p>There are many ways to recode, but I find base R’s functions intuitive enough. After defining a new variable <code>educ2</code>, the following code is best read from inside out. For example, if the original <code>educ</code> variable equals “Less than a high school graduate (0-11)” we give our new variable <code>educ2</code> a 1. Likewise, high school graduates get a value of 2. Producing a table of our new variable shows a clean output of each of our five new levels.</p>
<pre class="r"><code># Using base R is a bit more intuitive for me.
# Read from inside out. If educ == X then assign NA to gallup$educ2
gallup$educ2 &lt;- NA
gallup$educ2[gallup$educ == &#39;Less than a high school graduate (0-11)&#39;] &lt;- 1
gallup$educ2[gallup$educ == &#39;High school graduate (12)&#39;] &lt;- 2
gallup$educ2[gallup$educ == &#39;Trade/technical/vocational training&#39;] &lt;- 3
gallup$educ2[gallup$educ == &#39;Some college&#39;] &lt;- 3
gallup$educ2[gallup$educ == &#39;College graduate&#39;] &lt;- 4
gallup$educ2[gallup$educ == &#39;Postgraduate work or academic or professional degree&#39;] &lt;- 5

table(gallup$educ2)</code></pre>
<pre><code>## 
##   1   2   3   4   5 
##  20 173 224 253 197</code></pre>
<p>To finish, we can assign these levels new labels and save as a new factor variable. The final table shows our clean and recoded education variable.</p>
<pre class="r"><code># Generate new factor labels
gallup$educ2 &lt;- factor(gallup$educ2, labels = c(&quot;Less than HS&quot;, &quot;High School&quot;, &quot;Trade / Some col&quot;, &quot;College&quot;, &quot;Professional&quot;))

# Remove any missing values
gallup &lt;- filter(gallup, !is.na(educ2))

# Space permitting, always examine your original vs your recoded variable:
# table(gallup$educ2, gallup$educ)

# Examine final table
table(gallup$educ2)</code></pre>
<pre><code>## 
##     Less than HS      High School Trade / Some col          College 
##               20              173              224              253 
##     Professional 
##              197</code></pre>
<p>Replotting our bar chart shows the collapsed categories and new succinct labels.</p>
<pre class="r"><code>ggplot(gallup, aes(educ2)) + 
  geom_bar(aes(fill=sex), stat=&quot;count&quot;, position=&quot;dodge&quot;) + 
  coord_flip()</code></pre>
<p><img src="/code/logistic_gallup_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>To avoid confusion later on, I want to make sex a dichotomous variable.</p>
<pre class="r"><code># Initialize new variable
gallup$female &lt;- NA
# Recode
gallup$female[gallup$sex == &quot;Male&quot;] &lt;- 0
gallup$female[gallup$sex == &quot;Female&quot;] &lt;- 1
# Double check
table(gallup$female, gallup$sex)</code></pre>
<pre><code>##    
##     Male Female
##   0  338      0
##   1    0    529</code></pre>
<p>Another variable of interest is the respondent’s political party identification. Are republicans more supportive of priestly chastisty? Do political independents have strong opinions? An initial table shows five levels, of which we’ll only keep the first three.</p>
<pre class="r"><code># Initial examination
table(gallup$partyid)</code></pre>
<pre><code>## 
##            Republican              Democrat           Independent 
##                   313                   348                   159 
##      Some other party No preference/Refused 
##                    19                     4</code></pre>
<pre class="r"><code># Keep only those respondents in the three desired categories
gallup &lt;- filter(gallup, partyid == &quot;Republican&quot; | partyid == &quot;Democrat&quot; | partyid == &quot;Independent&quot;)

# Visual summary
ggplot(gallup, aes(partyid)) + 
  geom_bar(stat=&quot;count&quot;, position=&quot;dodge&quot;, aes(fill = partyid))</code></pre>
<p><img src="/code/logistic_gallup_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Most sociological studies of religion rely on some sort of attendance measure, and it makes sense to include it here. How often you attend mass surely affects your opinions of what goes on inside! This variable is intuitively coded, so all we’ll do to prepare is remove the “Don’t Knows”.</p>
<pre class="r"><code>table(gallup$attend)</code></pre>
<pre><code>## 
##       At least once a week Two or three times a month 
##                        325                        142 
##         About once a month         A few times a year 
##                         91                        154 
##            Seldom or never                 Don&#39;t know 
##                        107                          1</code></pre>
<pre class="r"><code>gallup &lt;- filter(gallup, attend != &quot;Don&#39;t know&quot;)</code></pre>
<p>The last variable I want to include is US geographic region. There are huge demographic differences in the concentration and race of US Catholics. While the northeast was home to most catholics in American history, the influx of immigrants from Latin America has shifted the power balance to the southern states. Furthermore, maybe one’s opinion of celibate clergy is related to the local concentration of catholics, or the distance from the nearest headline-grabbing diocese. Luckily, this variable is already clean and ready to go.</p>
<pre class="r"><code>table(gallup$region)</code></pre>
<pre><code>## 
##    East Midwest   South    West 
##     219     270     166     164</code></pre>
<pre class="r"><code>ggplot(gallup, aes(region)) +
  geom_bar(stat = &quot;count&quot;, aes(fill = region))</code></pre>
<p><img src="/code/logistic_gallup_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Our prepared dataset should have 819 observations of 98 variables after cleaning measures of age, education, sex, attendance, political identification and US region.</p>
<hr />
<p><a name="model"></a> <strong>Fitting Logistic Model</strong></p>
<hr />

            </div>
        </div>
    </div>
</section>


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-118509886-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>



  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
  

  <script type="text/javascript">
    hljs.initHighlightingOnLoad();
  </script>





</body>
</html>

